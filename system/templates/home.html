{% extends "base.html" %}
{% load static %}

{% block tit %}
<div class = 'fullscreen' style = 'flex-direction: column; position : fixed;'>
    <div style = 'display : flex ; gap : 1rem;'>
        <span class = 'CNNSletters'>C</span>
        <span class = 'CNNSletters'>N</span>
        <span class = 'CNNSletters'>N</span>
        <span class = 'CNNSletters'>S</span>
    </div>
    <div style = 'display : flex; gap :1rem;'>
        <span class = 'PL'>P</span>
        <span class = 'PL'>L</span>
        <span class = 'PL'>O</span>
        <span class = 'PL'>I</span>
        <span class = 'PL'>E</span>
        <span class = 'PL'>S</span>
        <span class = 'PL'>T</span>
        <span class = 'PL'>I</span>
    </div>
    <div style = 'display : flex; gap :1rem;'>
        <span class = 'Home'>H</span>
        <span class = 'Home'>O</span>
        <span class = 'Home'>M</span>
        <span class = 'Home'>E</span>
    </div>
</div>
{% endblock %}

{% block content %}
    {% if user.is_authenticated %}
    <div style = 'padding : 1rem;'>
        <div class = 'container display-flex align-items-center justify-content-center' style = 'gap : 1rem; flex-wrap: wrap;'>
            <div class = 'display-flex align-items-center justify-content-center w-100' style = 'gap : 1rem; flex-wrap: wrap; padding : .5rem;'>
                <img src="{{ user.profile.image.url }}" class = 'round' style = 'width : 3rem; height : 3rem;'>
                {% if user.is_superuser %}
                    <span style = 'min-width: 10rem; display : block; font-size: 1rem;' style = 'color: red;'>Welcome, ADMIN {{ user.username }} !</span> 
                {% else %}
                    <span style = 'min-width: 10rem; display : block; font-size: 1rem;' style = 'color: red;'>Welcome, {{ user.username }} !</span>    
                {% endif %}
                    <a href = '{% url "post-new" %}' class = 'zButon btnHover'>New Post</a>
                    <a href = '{% url "comment-new" %}' class = 'zButon btnHover '>New Comment</a>
                    <a href = '{% url "image-new" %}' class = 'zButon btnHover'>New Image</a>
            </div>
        </div>
    </div>
    {% if user.is_superuser %}
        <div class = 'display-flex align-items-center justify-content-center'>
            <a class = 'zButon btnHover' href = '{% url "clasaX" %}'>Clasa a X-a</a>
        </div>
        {% endif %}
    {% endif %}
   
    {% for post in posts %} 

        {% if post.class4post == user.last_name or user.is_superuser%}
    
        <!--<p>class 4 post : {{post.class4post}}</p>-->
        <div class = 'padding-1rem blogPost '>
            <div class = 'container display-flex align-items-center justify-content-center' style = 'justify-content: top;  flex-direction: column;'>  <br>
                <div style = 'width : 90%;' >
                    <div class = 'w-100 display-flex align-items-center' style = 'gap : .33rem;'>
                        <img src="{{ post.author.profile.image.url }}" class = 'round' style = 'width : 3rem; height : 3rem;'>
                        <h5 style = 'color : #552360;'>{{post.author}} </h5>
                        <h5>-</h5>  
                        <h5 style = 'color : gray;'>{{post.date_posted}}</h5> 
                    </div>
                    <hr>
                    <h2 id = 'elseBlock'>{{post.title}}</h2>
                    <p>{{post.content}}</p>
                    <div class="display-flex align-items-center justify-content-center" 
                        style = 'gap : 1rem;'>
                        <a href="{% url 'post-update' post.id %}" 
                            class = 'ifBlock zButon btnHover {{post.author}}{{post.id}}'>Update</a>
                            


                        <a href="{% url 'post-delete' post.id %}" 
                            class = 'ifBlock zButon btnHover {{post.author}}{{post.id}}'>Delete</a>
                            <!--aici este greseala-->
                        <button class = 'zButon btnHover buttonForComment' onclick = 'document.getElementById("{{post.title}}").style.display = "block";'>Comments</button>
                    </div>
                </div> <br>
                <script>

                if('{{user}}' == '{{post.author}}') {
                    document.querySelectorAll('.{{post.author}}{{post.id}}').forEach((e) =>{
                        e.style.display = 'block';
                    })
                }else {try {document.getElementById('#elseBlock').css.display = 'block';}
                    catch{}}
                </script>
            </div>
        </div>
        {% endif %}
            <!--si aici-->
        {% for comment in post.comments.all%}
            {% if comment.author|slugify  == user.username or user.is_superuser%}
                {% if comment.class4post == post.class4post %}

                <div class = 'padding-1rem ' id = '{{post.title}}' style = 'display: none;'>
                    <div class = 'container2 display-flex justify-content-center align-items-center' style = ' flex-direction: column; background-color: #d0c8cc;'>
                        <div style = 'width : 90%;' > <br>
                            <div class = 'w-100 display-flex display-flex align-items-center' style = 'gap : .33rem;'>
                                <img src="{{ comment.author.profile.image.url }}" class = 'round' style = 'width : 3rem; height : 3rem;'>
                                <h5 style = 'color : #552360;'>{{comment.author}} </h5>
                                <h5>-</h5>  
                                <h5 style = 'color : gray;'>{{comment.date_posted}}</h5> 
                            </div>
                            <p>{{comment.body}}</p>
                            <div class="display-flex align-items-center justify-content-center" 
                                style = 'gap : 1rem;'>
                                <a href="{% url 'comments-update' comment.id %}" 
                                    class = 'ifBlock zButon btnHover {{comment.author}}{{comment.id}}'>Update</a>
                        
                            
                                <a href="{% url 'comments-delete' comment.id %}" 
                                    class = 'ifBlock zButon btnHover {{comment.author}}{{comment.id}}'>Delete</a>
                            </div>
                        </div><br>
                        <script>
                            if('{{user}}' == '{{comment.author}}') {
                                document.querySelectorAll('.{{comment.author}}{{comment.id}}').forEach((e) =>{
                                    e.style.display = 'block';
                                })
                            }else {try {document.getElementById('#elseBlock').css.display = 'block';}
                                catch{}}
                        </script>
                    </div>
                </div>
                {% endif %}
            {% endif %}
        {% endfor %}
        </div>

        
    {% endfor %}

    {% for img in images %}
        {% if user.last_name == img.class4post or user.is_superuser%}
        <br>
        <div class = 'padding-1rem imagePost'>
            <div class = 'container display-flex align-items-center justify-content-center' style = 'justify-content: top; flex-direction: column;'>  <br>
                <div style = 'width : 90%;'>
                    <div class = 'w-100 display-flex display-flex align-items-center' style = 'gap : .33rem;'>
                        <img src="{{ img.author.profile.image.url }}" class = 'round' style = 'width : 3rem; height : 3rem;'>
                        <h5 style = 'color : #552360;'>{{img.author}} </h5>
                        <h5>-</h5>  
                        <h5 style = 'color : gray;'>{{img.date_posted}}</h5> 
                    </div><hr>
                    <h2 id = 'elseBlock'>{{img.title}}</h2>
                    <div class = 'w-100 display-flex align-items-center justify-content-center'>
                        <img src="/media/{{img.image}}" style = 'max-width: 100%; max-height: 40rem;'>
                    </div> <br>
                    <div class="display-flex align-items-center justify-content-center" 
                        style = 'gap : 1rem;'>

                        <a href="{% url 'image-update' img.id %}" 
                            class = 'ifBlock zButon btnHover {{img.author}}{{img.id}}'>Update</a>

                        

                        <a href="{% url 'image-delete' img.id %}" 
                            class = 'ifBlock zButon btnHover {{img.author}}{{img.id}}'>Delete</a>

                    </div> <br>
                </div>
                <script>
                if('{{user}}' == '{{img.author}}') {
                    document.querySelectorAll('.{{img.author}}{{img.id}}').forEach((e) =>{
                        e.style.display = 'block';
                    })
                }else {try {document.getElementById('#elseBlock').css.display = 'block';}
                    catch{}}
                </script>
            </div>
            
        </div>
        {% endif %}
    {% endfor %}

    <br> 
    <hr class="w-50">
    <div class = 'w-100 display-flex align-items-center justify-content-center'>
        <div class = 'w-50 display-flex align-items-center' style = 'justify-content: end; gap : .2rem;'>
            <a href = 'https://twitter.com/Z4queee'><img src="{% static 'imagesForBase/x.png' %}" style = 'height : 1.2rem;'></a>
            <a href = 'https://www.instagram.com/zanddry/'><img src="{% static 'imagesForBase/insta.png' %}" style = 'height : 1.2rem;'></a>
        </div>
    </div>
    <br>
{% endblock %}
